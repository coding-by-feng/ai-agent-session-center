<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agent Session Center</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%230a0a1a'/%3E%3Ccircle cx='16' cy='13' r='7' fill='none' stroke='%2300e5ff' stroke-width='2'/%3E%3Ccircle cx='13.5' cy='12' r='1.5' fill='%2300e5ff'/%3E%3Ccircle cx='18.5' cy='12' r='1.5' fill='%2300e5ff'/%3E%3Cpath d='M13 16 Q16 19 19 16' fill='none' stroke='%2300e5ff' stroke-width='1' stroke-linecap='round'/%3E%3Crect x='14.5' y='4' width='3' height='3' rx='1' fill='%2300e5ff'/%3E%3Cline x1='16' y1='7' x2='16' y2='6' stroke='%2300e5ff' stroke-width='1.5'/%3E%3Crect x='9' y='22' width='14' height='6' rx='2' fill='none' stroke='%23ff9100' stroke-width='1.5'/%3E%3Cline x1='12' y1='24' x2='12' y2='26' stroke='%23ff9100' stroke-width='1' stroke-linecap='round'/%3E%3Cline x1='16' y1='24' x2='16' y2='26' stroke='%23ff9100' stroke-width='1' stroke-linecap='round'/%3E%3Cline x1='20' y1='24' x2='20' y2='26' stroke='%23ff9100' stroke-width='1' stroke-linecap='round'/%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5/css/xterm.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5/lib/xterm.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0/lib/addon-fit.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-unicode11@0/lib/addon-unicode11.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-web-links@0/lib/addon-web-links.js"></script>
</head>
<body>
  <!-- Header -->
  <header id="header">
    <div class="header-title">
      AI AGENT SESSION CENTER
    </div>
    <div id="live-search-bar">
      <input type="text" id="live-search" placeholder="Filter sessions... ( / )">
    </div>
    <div id="global-stats"></div>
    <button id="open-settings" class="settings-gear" title="Settings (S)">&#9881;</button>
  </header>

  <!-- Navigation Bar -->
  <nav id="main-nav">
    <button class="nav-btn active" data-view="live">LIVE SESSIONS</button>
    <button class="nav-btn" data-view="history">SESSION HISTORY</button>
    <button class="nav-btn" data-view="timeline">TIMELINE</button>
    <button class="nav-btn" data-view="analytics">ANALYTICS</button>
    <div class="nav-spacer"></div>
    <div id="nav-actions">
      <button id="nav-actions-toggle" class="nav-actions-toggle" title="Toggle actions">&#9776;</button>
      <div id="nav-actions-items">
        <button id="qa-new-session" class="qa-btn qa-btn-terminal" title="Launch a new Claude session via SSH">+ NEW SESSION</button>
        <button id="qa-quick-session" class="qa-btn qa-btn-quick" title="Quick launch with last config + label">&#9889; QUICK</button>
        <button id="qa-oneoff" class="qa-btn qa-btn-oneoff" title="Launch a one-off session (auto-review reminder)">ONEOFF</button>
        <button id="qa-heavy" class="qa-btn qa-btn-heavy" title="Launch a high-priority session (auto-pinned, bold frame)">&#9733; HEAVY</button>
        <button id="qa-important" class="qa-btn qa-btn-important" title="Launch an important session (alert on completion)">&#9888; IMPORTANT</button>
        <button id="qa-new-group" class="qa-btn" title="Create a new group">+ NEW GROUP</button>
        <div class="qa-separator"></div>
        <button id="qa-mute-all" class="qa-btn" title="Mute all sessions">&#9835; MUTE ALL</button>
        <button id="qa-archive-ended" class="qa-btn" title="Archive all ended sessions">&#8681; ARCHIVE ENDED</button>
      </div>
      <button id="shortcuts-btn" class="nav-shortcuts-btn" title="Keyboard Shortcuts (?)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="3" width="14" height="10" rx="2"/><line x1="4" y1="6" x2="5" y2="6"/><line x1="7" y1="6" x2="9" y2="6"/><line x1="11" y1="6" x2="12" y2="6"/><line x1="4" y1="9" x2="12" y2="9"/></svg></button>
    </div>
  </nav>

  <!-- Keyboard Shortcuts Panel -->
  <div id="shortcuts-modal" class="modal-overlay hidden">
    <div class="modal-panel shortcuts-panel">
      <div class="shortcuts-header">
        <h3>Keyboard Shortcuts</h3>
        <button id="shortcuts-close" class="modal-close">&times;</button>
      </div>
      <div class="shortcuts-body">
        <div class="shortcuts-section">
          <h4>Global</h4>
          <div class="shortcut-row"><kbd>/</kbd><span>Focus search</span></div>
          <div class="shortcut-row"><kbd>S</kbd><span>Toggle settings</span></div>
          <div class="shortcut-row"><kbd>M</kbd><span>Mute / unmute all</span></div>
          <div class="shortcut-row"><kbd>T</kbd><span>New session (none selected)</span></div>
          <div class="shortcut-row"><kbd>Esc</kbd><span>Close modal / panel (except terminal tab)</span></div>
          <div class="shortcut-row"><kbd>?</kbd><span>Toggle this panel</span></div>
        </div>
        <div class="shortcuts-section">
          <h4>Selected Session</h4>
          <div class="shortcut-row"><kbd>K</kbd><span>Kill process</span></div>
          <div class="shortcut-row"><kbd>A</kbd><span>Archive session</span></div>
        </div>
        <div class="shortcuts-section">
          <h4>Terminal</h4>
          <div class="shortcut-row"><kbd>Alt+F11</kbd><span>Toggle fullscreen</span></div>
          <div class="shortcut-row"><kbd>Ctrl+Enter</kbd><span>Send queued prompt</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Live Sessions View -->
  <div id="view-live" class="view-panel active">
    <!-- Group containers injected here -->
    <div id="groups-container"></div>

    <!-- Ungrouped Session Cards Grid -->
    <main id="sessions-grid"></main>

    <!-- Empty State -->
    <div id="empty-state">
      <div class="empty-icon">&#9679;</div>
      <h2>No Active Sessions</h2>
      <p>Open a Claude Code session to see it appear here</p>
    </div>

  </div>

  <!-- Session History View -->
  <div id="view-history" class="view-panel hidden">
    <div id="history-controls">
      <input type="text" id="search-input" placeholder="Search sessions...">
      <select id="history-project-filter">
        <option value="">All Projects</option>
      </select>
      <select id="history-status-filter">
        <option value="">All Statuses</option>
        <option value="ended">Ended</option>
        <option value="idle">Idle</option>
        <option value="working">Working</option>
        <option value="waiting">Waiting</option>
        <option value="archived">Archived</option>
      </select>
      <input type="date" id="history-date-from" placeholder="From">
      <input type="date" id="history-date-to" placeholder="To">
      <select id="history-sort-by">
        <option value="date">Date</option>
        <option value="duration">Duration</option>
        <option value="prompts">Prompts</option>
        <option value="tools">Tools</option>
      </select>
      <button id="history-sort-dir" class="nav-btn" title="Toggle sort direction">DESC</button>
    </div>
    <div id="history-results"></div>
    <div id="history-pagination"></div>
  </div>

  <!-- Timeline View -->
  <div id="view-timeline" class="view-panel hidden">
    <div id="timeline-controls">
      <select id="timeline-granularity">
        <option value="hour">Hourly</option>
        <option value="day">Daily</option>
        <option value="week">Weekly</option>
      </select>
      <select id="timeline-project-filter">
        <option value="">All Projects</option>
      </select>
      <input type="date" id="timeline-date-from" placeholder="From">
      <input type="date" id="timeline-date-to" placeholder="To">
    </div>
    <div id="timeline-chart"></div>
  </div>

  <!-- Analytics View -->
  <div id="view-analytics" class="view-panel hidden">
    <div id="analytics-summary"></div>
    <div id="analytics-grid">
      <div class="analytics-card">
        <h4>Tool Usage</h4>
        <div id="tool-usage-chart"></div>
      </div>
      <div class="analytics-card">
        <h4>Duration Trends</h4>
        <div id="duration-trends-chart"></div>
      </div>
      <div class="analytics-card">
        <h4>Active Projects</h4>
        <div id="active-projects-chart"></div>
      </div>
      <div class="analytics-card">
        <h4>Daily Heatmap</h4>
        <div id="daily-heatmap-chart"></div>
      </div>
    </div>
  </div>

  <!-- Activity Feed -->
  <footer id="activity-feed" class="collapsed">
    <div class="feed-header">
      <span>ACTIVITY FEED</span>
      <button id="feed-collapse-btn" class="feed-collapse-btn" title="Collapse activity feed">&#9660;</button>
    </div>
    <div id="feed-entries"></div>
  </footer>

  <!-- Click-to-Select Detail Panel (slides in from right) -->
  <div id="session-detail-overlay" class="hidden">
    <div id="session-detail-panel">
      <div class="detail-resize-handle" id="detail-resize-handle"></div>
      <button id="close-detail">&times;</button>
      <div class="detail-header">
        <div class="detail-char-preview" id="detail-char-preview"></div>
        <div class="detail-header-text">
          <div class="detail-header-top">
            <div class="detail-header-titles">
              <h3 id="detail-project-name"></h3>
              <div class="detail-title-row">
                <input type="text" id="detail-title" placeholder="Add session title..." class="detail-title-input">
                <input type="text" id="detail-label" list="detail-label-suggestions" placeholder="Label..." class="detail-label-input" autocomplete="off">
                <datalist id="detail-label-suggestions"></datalist>
              </div>
              <div class="detail-label-chips" id="detail-label-chips"></div>
            </div>
            <select id="detail-char-model" class="detail-char-select">
              <option value="">Default (global)</option>
              <option value="robot">Robot</option>
              <option value="cat">Cat</option>
              <option value="alien">Alien</option>
              <option value="ghost">Ghost</option>
              <option value="orb">Orb</option>
              <option value="dragon">Dragon</option>
              <option value="penguin">Penguin</option>
              <option value="octopus">Octopus</option>
              <option value="mushroom">Mushroom</option>
              <option value="fox">Fox</option>
              <option value="unicorn">Unicorn</option>
              <option value="jellyfish">Jellyfish</option>
              <option value="owl">Owl</option>
              <option value="bat">Bat</option>
              <option value="cactus">Cactus</option>
              <option value="slime">Slime</option>
              <option value="pumpkin">Pumpkin</option>
              <option value="yeti">Yeti</option>
              <option value="crystal">Crystal</option>
              <option value="bee">Bee</option>
            </select>
          </div>
          <div class="detail-meta">
            <span id="detail-status-badge"></span>
            <span id="detail-model"></span>
            <span id="detail-duration"></span>
          </div>
        </div>
      </div>

      <!-- Control buttons -->
      <div class="ctrl-bar">
        <button class="ctrl-btn kill" id="ctrl-kill" title="Kill Process">KILL</button>
        <button class="ctrl-btn archive" id="ctrl-archive" title="Move to History">ARCHIVE</button>
        <button class="ctrl-btn summarize" id="ctrl-summarize" title="Summarize & Archive">SUMMARIZE</button>
        <button class="ctrl-btn delete" id="ctrl-delete" title="Permanently Delete Session">DELETE</button>
        <button class="ctrl-btn alert" id="ctrl-alert" title="Duration Alert">ALERT</button>
        <select id="detail-group-select" class="ctrl-select" title="Assign to group">
          <option value="">No group</option>
        </select>
      </div>

      <!-- Tab navigation -->
      <div class="detail-tabs">
        <button class="tab active" data-tab="terminal">Terminal</button>
        <button class="tab" data-tab="conversation">Prompt History</button>
        <button class="tab" data-tab="notes">Notes</button>
        <button class="tab" data-tab="activity">Activity</button>
        <button class="tab" data-tab="summary">Summary</button>
      </div>

      <!-- Terminal Tab -->
      <div class="tab-content active" id="tab-terminal">
        <div class="terminal-toolbar">
          <div id="terminal-status" class="terminal-status">Not connected</div>
          <button id="terminal-fullscreen-btn" class="terminal-fullscreen-btn" title="Fullscreen (F11)">&#x26F6; FULLSCREEN</button>
        </div>
        <div id="terminal-container"></div>
        <!-- Collapsible Prompt Queue below terminal -->
        <div id="terminal-queue-panel" class="terminal-queue-panel collapsed">
          <button id="terminal-queue-toggle" class="terminal-queue-toggle">
            <span class="terminal-queue-toggle-arrow">&#9654;</span>
            PROMPT QUEUE <span id="terminal-queue-count" class="terminal-queue-count"></span>
          </button>
          <div class="terminal-queue-body">
            <div class="queue-compose">
              <textarea id="queue-textarea" placeholder="Add a prompt to the queue..." rows="2"></textarea>
              <button id="queue-add-btn" class="ctrl-btn queue">ADD</button>
            </div>
            <div id="queue-list" class="terminal-queue-list"></div>
          </div>
        </div>
      </div>

      <!-- Prompt History Tab -->
      <div class="tab-content" id="tab-conversation">
        <div id="detail-conversation"></div>
      </div>

      <!-- Notes Tab -->
      <div class="tab-content" id="tab-notes">
        <div class="notes-compose">
          <textarea id="note-textarea" placeholder="Add a note..." rows="3"></textarea>
          <button id="save-note" class="ctrl-btn notes">Save Note</button>
        </div>
        <div id="notes-list"></div>
      </div>

      <!-- Activity Tab (combined tool calls, events, responses) -->
      <div class="tab-content" id="tab-activity">
        <div id="detail-activity-log"></div>
      </div>

      <!-- Summary Tab -->
      <div class="tab-content" id="tab-summary">
        <div id="summary-content">
          <div class="tab-empty">No summary yet — click SUMMARIZE to generate one with AI</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Team Detail Modal -->
  <div id="team-modal" class="modal-overlay hidden">
    <div class="modal-panel team-modal-panel">
      <div class="team-modal-header">
        <h3 id="team-modal-name">Team</h3>
        <span id="team-modal-count" class="team-modal-count">0 members</span>
        <button id="team-modal-close" class="modal-close">&times;</button>
      </div>
      <div id="team-modal-grid" class="team-modal-grid"></div>
    </div>
  </div>

  <!-- Summarize Prompt Selector Modal -->
  <div id="summarize-modal" class="modal-overlay hidden">
    <div class="modal-panel summarize-modal-panel">
      <div class="summarize-modal-header">
        <h3>Summarize Session</h3>
        <button id="summarize-modal-close" class="modal-close">&times;</button>
      </div>
      <div class="summarize-modal-body">
        <label class="summarize-label">Select a prompt template:</label>
        <div id="summarize-prompt-list" class="summarize-prompt-list"></div>
        <div class="summarize-custom-section">
          <button id="summarize-toggle-custom" class="summarize-toggle-custom">+ Custom prompt</button>
          <div id="summarize-custom-form" class="summarize-custom-form hidden">
            <input type="text" id="summarize-custom-name" placeholder="Template name (e.g. Sprint Review)" class="summarize-custom-name">
            <textarea id="summarize-custom-prompt" placeholder="Write your summary prompt instructions here..." class="summarize-custom-prompt" rows="8"></textarea>
            <div class="summarize-custom-actions">
              <button id="summarize-save-template" class="ctrl-btn notes">Save as Template</button>
              <button id="summarize-use-once" class="ctrl-btn summarize">Use Once</button>
            </div>
          </div>
        </div>
      </div>
      <div class="summarize-modal-footer">
        <button id="summarize-cancel" class="ctrl-btn">Cancel</button>
        <button id="summarize-run" class="ctrl-btn summarize" disabled>Summarize</button>
      </div>
    </div>
  </div>

  <!-- Kill Confirmation Modal -->
  <div id="kill-modal" class="modal-overlay hidden">
    <div class="modal-panel">
      <h3>Confirm Kill</h3>
      <p id="kill-modal-msg">Are you sure you want to kill this session?</p>
      <p style="font-size:10px;color:var(--accent-red);margin-bottom:12px;">This will send SIGTERM to the Claude process. Unsaved work may be lost.</p>
      <div class="modal-actions">
        <button id="kill-cancel" class="ctrl-btn">Cancel</button>
        <button id="kill-confirm" class="ctrl-btn kill">Kill Process</button>
      </div>
    </div>
  </div>

  <!-- Alert Configuration Modal -->
  <div id="alert-modal" class="modal-overlay hidden">
    <div class="modal-panel">
      <h3>Set Duration Alert</h3>
      <p>Alert when session exceeds:</p>
      <div class="alert-input-row">
        <input type="number" id="alert-minutes" min="1" value="30" class="alert-input">
        <span>minutes</span>
      </div>
      <div class="modal-actions">
        <button id="alert-cancel" class="ctrl-btn">Cancel</button>
        <button id="alert-confirm" class="ctrl-btn alert">Set Alert</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal-overlay hidden">
    <div class="modal-panel settings-panel">
      <div class="settings-header">
        <h3>Settings</h3>
        <span id="settings-autosave" class="autosave-indicator">Saved</span>
        <button id="close-settings" class="modal-close">&times;</button>
      </div>

      <!-- Settings Tab Bar -->
      <div class="settings-tabs">
        <button class="settings-tab active" data-settings-tab="appearance">Appearance</button>
        <button class="settings-tab" data-settings-tab="sounds">Sounds</button>
        <button class="settings-tab" data-settings-tab="labels">Labels</button>
        <button class="settings-tab" data-settings-tab="advanced">Advanced</button>
      </div>

      <!-- Appearance Tab -->
      <div class="settings-tab-content active" id="settings-tab-appearance">
        <div class="settings-section">
          <h4>Theme</h4>
          <div class="theme-grid" id="theme-grid">
            <button class="theme-swatch active" data-theme="command-center" title="Command Center">
              <div class="swatch-colors"><span style="background:#0a0a1a"></span><span style="background:#00e5ff"></span><span style="background:#ff9100"></span></div>
              <span class="swatch-label">Command Center</span>
            </button>
            <button class="theme-swatch" data-theme="cyberpunk" title="Cyberpunk">
              <div class="swatch-colors"><span style="background:#0d0221"></span><span style="background:#ff00ff"></span><span style="background:#00ffff"></span></div>
              <span class="swatch-label">Cyberpunk</span>
            </button>
            <button class="theme-swatch" data-theme="warm" title="Warm">
              <div class="swatch-colors"><span style="background:#faf6f1"></span><span style="background:#d97706"></span><span style="background:#b87333"></span></div>
              <span class="swatch-label">Warm</span>
            </button>
            <button class="theme-swatch" data-theme="dracula" title="Dracula">
              <div class="swatch-colors"><span style="background:#282a36"></span><span style="background:#bd93f9"></span><span style="background:#50fa7b"></span></div>
              <span class="swatch-label">Dracula</span>
            </button>
            <button class="theme-swatch" data-theme="solarized" title="Solarized">
              <div class="swatch-colors"><span style="background:#002b36"></span><span style="background:#2aa198"></span><span style="background:#cb4b16"></span></div>
              <span class="swatch-label">Solarized</span>
            </button>
            <button class="theme-swatch" data-theme="nord" title="Nord">
              <div class="swatch-colors"><span style="background:#2e3440"></span><span style="background:#88c0d0"></span><span style="background:#d08770"></span></div>
              <span class="swatch-label">Nord</span>
            </button>
            <button class="theme-swatch" data-theme="monokai" title="Monokai">
              <div class="swatch-colors"><span style="background:#272822"></span><span style="background:#66d9ef"></span><span style="background:#f92672"></span></div>
              <span class="swatch-label">Monokai</span>
            </button>
            <button class="theme-swatch" data-theme="light" title="Light">
              <div class="swatch-colors"><span style="background:#f0f2f5"></span><span style="background:#0ea5e9"></span><span style="background:#3b82f6"></span></div>
              <span class="swatch-label">Light</span>
            </button>
            <button class="theme-swatch" data-theme="blonde" title="Blonde">
              <div class="swatch-colors"><span style="background:#fdf8ef"></span><span style="background:#ca8a04"></span><span style="background:#a16207"></span></div>
              <span class="swatch-label">Blonde</span>
            </button>
          </div>
        </div>

        <div class="settings-section">
          <h4>Font Size</h4>
          <div class="font-size-control">
            <button class="font-btn" id="font-decrease">A-</button>
            <span id="font-size-display">13px</span>
            <button class="font-btn" id="font-increase">A+</button>
            <input type="range" id="font-size-slider" min="10" max="20" value="13" step="1">
          </div>
        </div>

        <div class="settings-section">
          <h4>Scanline Effect</h4>
          <label class="toggle-label">
            <input type="checkbox" id="scanline-enabled" checked>
            <span class="toggle-switch"></span>
            Enable scanline overlay
          </label>
        </div>

        <div class="settings-section">
          <h4>Animation</h4>
          <label style="font-size:11px;color:var(--text-secondary);margin-bottom:6px;display:block;">Intensity (range of movement)</label>
          <div class="anim-intensity-control">
            <span>Low</span>
            <input type="range" id="anim-intensity-slider" min="0" max="200" value="100" step="10">
            <span id="anim-intensity-display">100%</span>
          </div>
          <label style="font-size:11px;color:var(--text-secondary);margin-bottom:6px;margin-top:8px;display:block;">Speed</label>
          <div class="anim-intensity-control">
            <span>Slow</span>
            <input type="range" id="anim-speed-slider" min="30" max="200" value="100" step="10">
            <span id="anim-speed-display">100%</span>
          </div>

          <h4 style="margin-top:16px;">Per-Action Movement Effects</h4>
          <div class="movement-preview-section">
            <div class="movement-preview-viewport" id="movement-preview-viewport">
              <div class="movement-preview-label">Select an effect and click <strong>&#9654;</strong> to preview</div>
            </div>
          </div>
          <div id="movement-action-grid" class="sound-action-grid"></div>
        </div>

        <div class="settings-section">
          <h4>Character Model</h4>
          <div class="char-grid" id="char-model-grid">
            <button class="char-swatch active" data-model="robot" title="Robot">
              <div class="char-preview char-preview-robot">
                <div class="cp-antenna"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
              </div>
              <span class="char-label">Robot</span>
            </button>
            <button class="char-swatch" data-model="cat" title="Cat">
              <div class="char-preview char-preview-cat">
                <div class="cp-ear cp-ear-l"></div><div class="cp-ear cp-ear-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
                <div class="cp-tail"></div>
              </div>
              <span class="char-label">Cat</span>
            </button>
            <button class="char-swatch" data-model="alien" title="Alien">
              <div class="char-preview char-preview-alien">
                <div class="cp-dome"><div class="cp-eye"></div><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
              </div>
              <span class="char-label">Alien</span>
            </button>
            <button class="char-swatch" data-model="ghost" title="Ghost">
              <div class="char-preview char-preview-ghost">
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-tail"></div>
              </div>
              <span class="char-label">Ghost</span>
            </button>
            <button class="char-swatch" data-model="orb" title="Orb">
              <div class="char-preview char-preview-orb">
                <div class="cp-core"></div>
                <div class="cp-ring"></div>
              </div>
              <span class="char-label">Orb</span>
            </button>
            <button class="char-swatch" data-model="dragon" title="Dragon">
              <div class="char-preview char-preview-dragon">
                <div class="cp-horn cp-horn-l"></div><div class="cp-horn cp-horn-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"><div class="cp-wing"></div></div>
              </div>
              <span class="char-label">Dragon</span>
            </button>
            <button class="char-swatch" data-model="penguin" title="Penguin">
              <div class="char-preview char-preview-penguin">
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-beak"></div>
                <div class="cp-body"></div>
              </div>
              <span class="char-label">Penguin</span>
            </button>
            <button class="char-swatch" data-model="octopus" title="Octopus">
              <div class="char-preview char-preview-octopus">
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-tentacles"></div>
              </div>
              <span class="char-label">Octopus</span>
            </button>
            <button class="char-swatch" data-model="mushroom" title="Mushroom">
              <div class="char-preview char-preview-mushroom">
                <div class="cp-cap"><div class="cp-spot"></div><div class="cp-spot"></div></div>
                <div class="cp-stem"></div>
              </div>
              <span class="char-label">Mushroom</span>
            </button>
            <button class="char-swatch" data-model="fox" title="Fox">
              <div class="char-preview char-preview-fox">
                <div class="cp-ear cp-ear-l"></div><div class="cp-ear cp-ear-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
                <div class="cp-tail"></div>
              </div>
              <span class="char-label">Fox</span>
            </button>
            <button class="char-swatch" data-model="unicorn" title="Unicorn">
              <div class="char-preview char-preview-unicorn">
                <div class="cp-horn"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
              </div>
              <span class="char-label">Unicorn</span>
            </button>
            <button class="char-swatch" data-model="jellyfish" title="Jellyfish">
              <div class="char-preview char-preview-jellyfish">
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-tentacles"></div>
              </div>
              <span class="char-label">Jellyfish</span>
            </button>
            <button class="char-swatch" data-model="owl" title="Owl">
              <div class="char-preview char-preview-owl">
                <div class="cp-tuft cp-tuft-l"></div><div class="cp-tuft cp-tuft-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-beak"></div>
              </div>
              <span class="char-label">Owl</span>
            </button>
            <button class="char-swatch" data-model="bat" title="Bat">
              <div class="char-preview char-preview-bat">
                <div class="cp-ear cp-ear-l"></div><div class="cp-ear cp-ear-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-wing"></div>
              </div>
              <span class="char-label">Bat</span>
            </button>
            <button class="char-swatch" data-model="cactus" title="Cactus">
              <div class="char-preview char-preview-cactus">
                <div class="cp-flower"></div>
                <div class="cp-body"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-arm"></div>
              </div>
              <span class="char-label">Cactus</span>
            </button>
            <button class="char-swatch" data-model="slime" title="Slime">
              <div class="char-preview char-preview-slime">
                <div class="cp-body"><div class="cp-eye"></div><div class="cp-eye"></div></div>
              </div>
              <span class="char-label">Slime</span>
            </button>
            <button class="char-swatch" data-model="pumpkin" title="Pumpkin">
              <div class="char-preview char-preview-pumpkin">
                <div class="cp-stem"></div>
                <div class="cp-body"><div class="cp-eye"></div><div class="cp-eye"></div></div>
              </div>
              <span class="char-label">Pumpkin</span>
            </button>
            <button class="char-swatch" data-model="yeti" title="Yeti">
              <div class="char-preview char-preview-yeti">
                <div class="cp-horn cp-horn-l"></div><div class="cp-horn cp-horn-r"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
              </div>
              <span class="char-label">Yeti</span>
            </button>
            <button class="char-swatch" data-model="crystal" title="Crystal">
              <div class="char-preview char-preview-crystal">
                <div class="cp-body"><div class="cp-eye"></div><div class="cp-eye"></div></div>
              </div>
              <span class="char-label">Crystal</span>
            </button>
            <button class="char-swatch" data-model="bee" title="Bee">
              <div class="char-preview char-preview-bee">
                <div class="cp-antenna"></div>
                <div class="cp-head"><div class="cp-eye"></div><div class="cp-eye"></div></div>
                <div class="cp-body"></div>
                <div class="cp-wing"></div>
              </div>
              <span class="char-label">Bee</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Sounds Tab -->
      <div class="settings-tab-content" id="settings-tab-sounds">
        <div class="settings-section">
          <h4>Master Controls</h4>
          <div class="sound-controls">
            <label class="toggle-label">
              <input type="checkbox" id="sound-enabled" checked>
              <span class="toggle-switch"></span>
              Enable Sounds
            </label>
            <div class="volume-control">
              <span>Volume</span>
              <input type="range" id="sound-volume" min="0" max="1" step="0.1" value="0.5">
              <span id="volume-display">50%</span>
            </div>
          </div>
        </div>
        <div class="settings-section">
          <h4>Per-Action Sounds</h4>
          <div id="sound-action-grid" class="sound-action-grid"></div>
        </div>
      </div>

      <!-- Labels Tab -->
      <div class="settings-tab-content" id="settings-tab-labels">
        <div class="settings-section">
          <h4>Built-in Label Alerts</h4>
          <p class="settings-hint">Configure which sound and movement effect plays when a labeled session completes. These alerts fire on session end for ONEOFF, HEAVY, and IMPORTANT sessions.</p>
          <div id="label-settings-grid" class="label-settings-grid"></div>
        </div>
      </div>

      <!-- Advanced Tab -->
      <div class="settings-tab-content" id="settings-tab-advanced">
        <div class="settings-section">
          <h4>Anthropic API Key <span class="settings-hint">(Claude Code)</span></h4>
          <p class="settings-hint">Set once — automatically used for all Claude sessions.</p>
          <div class="api-key-row">
            <input type="password" id="settings-api-key" placeholder="sk-ant-..." class="settings-input api-key-input">
            <button id="settings-api-key-toggle" class="api-key-toggle" title="Show/hide">SHOW</button>
            <button id="settings-api-key-save" class="ctrl-btn notes">Save</button>
          </div>
          <div id="settings-api-key-status" class="settings-hint" style="margin-top:4px;"></div>
        </div>
        <div class="settings-section">
          <h4>OpenAI API Key <span class="settings-hint">(Codex CLI)</span></h4>
          <p class="settings-hint">Used when launching Codex CLI sessions.</p>
          <div class="api-key-row">
            <input type="password" id="settings-openai-key" placeholder="sk-..." class="settings-input api-key-input">
            <button id="settings-openai-key-toggle" class="api-key-toggle" title="Show/hide">SHOW</button>
            <button id="settings-openai-key-save" class="ctrl-btn notes">Save</button>
          </div>
          <div id="settings-openai-key-status" class="settings-hint" style="margin-top:4px;"></div>
        </div>
        <div class="settings-section">
          <h4>Google API Key <span class="settings-hint">(Gemini CLI)</span></h4>
          <p class="settings-hint">Used when launching Gemini CLI sessions.</p>
          <div class="api-key-row">
            <input type="password" id="settings-gemini-key" placeholder="AIza..." class="settings-input api-key-input">
            <button id="settings-gemini-key-toggle" class="api-key-toggle" title="Show/hide">SHOW</button>
            <button id="settings-gemini-key-save" class="ctrl-btn notes">Save</button>
          </div>
          <div id="settings-gemini-key-status" class="settings-hint" style="margin-top:4px;"></div>
        </div>

        <div class="settings-section">
          <h4>Hook Trace Density</h4>
          <p class="settings-hint">Controls which Claude Code events are tracked. Higher density = more detail but more overhead.</p>
          <div id="hook-density-control" class="density-control">
            <button class="density-btn" data-density="low">
              <span class="density-btn-label">Low</span>
              <span class="density-btn-desc">4 events: start, prompt, stop, end</span>
            </button>
            <button class="density-btn" data-density="medium">
              <span class="density-btn-label">Medium</span>
              <span class="density-btn-desc">7 events: + notifications, subagents</span>
            </button>
            <button class="density-btn" data-density="high">
              <span class="density-btn-label">High</span>
              <span class="density-btn-desc">9 events: + every tool call</span>
            </button>
          </div>
          <div class="density-actions">
            <button id="hook-install-btn" class="ctrl-btn notes">Install</button>
            <button id="hook-uninstall-btn" class="ctrl-btn kill hidden">Uninstall</button>
          </div>
          <div id="hook-density-status" class="density-status">
            <span class="hook-status-dot"></span> Checking...
          </div>
        </div>

        <div class="settings-section">
          <h4>Summary Prompt Templates</h4>
          <p class="settings-hint">Manage prompt templates used when summarizing sessions. Click the star to set as default.</p>
          <div id="settings-prompt-list" class="settings-prompt-list"></div>
          <div class="settings-prompt-form">
            <input type="text" id="settings-prompt-name" placeholder="Template name" class="settings-prompt-input">
            <textarea id="settings-prompt-text" placeholder="Write your summary instructions..." class="settings-prompt-textarea" rows="6"></textarea>
            <div class="settings-prompt-form-actions">
              <button id="settings-prompt-save" class="ctrl-btn notes">Add Template</button>
              <button id="settings-prompt-cancel-edit" class="ctrl-btn hidden">Cancel Edit</button>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h4>Import / Export</h4>
          <div class="advanced-actions">
            <button id="export-settings" class="ctrl-btn export">Export Settings</button>
            <button id="import-settings-btn" class="ctrl-btn notes">Import Settings</button>
            <input type="file" id="import-settings-file" accept=".json" class="hidden">
          </div>
        </div>

        <div class="settings-section">
          <h4>Reset</h4>
          <button id="reset-defaults" class="ctrl-btn kill">Reset All to Defaults</button>
        </div>

        <div class="settings-section">
          <h4>Display</h4>
          <label class="toggle-label">
            <input type="checkbox" id="activity-feed-visible" checked>
            <span class="toggle-switch"></span>
            Show activity feed
          </label>
        </div>
      </div>
    </div>
  </div>


  <!-- New Session Modal -->
  <div id="new-session-modal" class="modal-overlay hidden">
    <div class="modal-panel new-session-panel">
      <div class="new-session-header">
        <h3>Launch Session</h3>
        <button id="new-session-close" class="modal-close">&times;</button>
      </div>
      <div class="new-session-body">
        <div class="ssh-field-row">
          <div class="ssh-field ssh-field-grow">
            <label>Session Label <span class="ssh-field-hint">(reusable tag)</span></label>
            <input id="ssh-session-label" list="label-suggestions" placeholder="e.g. frontend, api, debug..." autocomplete="off">
            <datalist id="label-suggestions"></datalist>
          </div>
          <div class="ssh-field ssh-field-grow">
            <label>Session Title <span class="ssh-field-hint">(optional override)</span></label>
            <input id="ssh-session-title" placeholder="Auto: project + label + #">
          </div>
        </div>
        <div class="ssh-field-row">
          <div class="ssh-field ssh-field-grow">
            <label>Host</label>
            <input id="ssh-host" value="localhost" placeholder="hostname or IP">
          </div>
          <div class="ssh-field ssh-field-small">
            <label>Port</label>
            <input id="ssh-port" type="number" value="22">
          </div>
        </div>
        <div class="ssh-field">
          <label>Username</label>
          <input id="ssh-username" placeholder="your username">
        </div>
        <div class="ssh-field">
          <label>Auth Method</label>
          <select id="ssh-auth-method">
            <option value="key">SSH Key (~/.ssh/id_rsa)</option>
            <option value="agent">SSH Agent</option>
            <option value="password">Password</option>
          </select>
        </div>
        <div class="ssh-field hidden" id="ssh-password-row">
          <label>Password</label>
          <input id="ssh-password" type="password" placeholder="SSH password">
        </div>
        <div class="ssh-field" id="ssh-key-row">
          <label>Key File</label>
          <select id="ssh-key-select">
            <option value="">Loading keys...</option>
          </select>
        </div>
        <div class="ssh-field">
          <label>Working Directory</label>
          <input id="ssh-workdir" value="~" placeholder="~/projects/my-app">
        </div>
        <div class="ssh-field">
          <label>Session Mode</label>
          <div class="ssh-mode-toggle">
            <button class="ssh-mode-btn active" data-mode="new">New Session</button>
            <button class="ssh-mode-btn" data-mode="tmux-attach">Attach tmux</button>
            <button class="ssh-mode-btn" data-mode="tmux-wrap">Wrap in tmux</button>
          </div>
        </div>
        <div class="ssh-field hidden" id="ssh-tmux-row">
          <label>tmux Sessions <button id="ssh-tmux-refresh" class="ssh-tmux-refresh" title="Refresh session list">&#8635;</button></label>
          <div id="ssh-tmux-list" class="ssh-tmux-list">
            <div class="ssh-tmux-empty">Click refresh to load sessions</div>
          </div>
        </div>
        <div class="ssh-field">
          <label>Command</label>
          <select id="ssh-command-preset">
            <option value="claude">Claude Code</option>
            <option value="claude --dangerously-skip-permissions">Claude Code (skip permissions)</option>
            <option value="codex">Codex CLI</option>
            <option value="gemini">Gemini CLI</option>
            <option value="custom">Custom command...</option>
          </select>
        </div>
        <div class="ssh-field hidden" id="ssh-custom-row">
          <label>Custom Command</label>
          <input id="ssh-custom-command" placeholder="e.g. claude --verbose">
        </div>
        <div class="ssh-field">
          <label>API Key <span class="ssh-field-hint">(optional — overrides global setting)</span></label>
          <input id="ssh-api-key" type="password" placeholder="Uses global key if empty">
        </div>
        <div class="ssh-field">
          <label>Terminal Theme</label>
          <select id="ssh-terminal-theme">
            <option value="default">Default (Dashboard)</option>
            <option value="dark">Dark</option>
            <option value="monokai">Monokai</option>
            <option value="dracula">Dracula</option>
            <option value="solarized-dark">Solarized Dark</option>
            <option value="nord">Nord</option>
            <option value="github-dark">GitHub Dark</option>
          </select>
        </div>
      </div>
      <div class="new-session-footer">
        <button id="ssh-connect" class="ctrl-btn terminal">CONNECT & LAUNCH</button>
        <button id="ssh-cancel" class="ctrl-btn kill">CANCEL</button>
      </div>
    </div>
  </div>


  <!-- Quick Session Modal -->
  <div id="quick-session-modal" class="modal-overlay hidden">
    <div class="modal-panel quick-session-panel">
      <div class="quick-session-header">
        <h3>Quick Session</h3>
        <button id="quick-session-close" class="modal-close">&times;</button>
      </div>
      <div class="quick-session-body">
        <p class="quick-session-hint">Pick a label and launch with your last saved config.</p>
        <div class="quick-label-chips" id="quick-label-chips"></div>
        <div class="quick-label-input-row">
          <input id="quick-label-input" list="quick-label-suggestions" placeholder="Or type a new label..." autocomplete="off">
          <datalist id="quick-label-suggestions"></datalist>
        </div>
        <div class="quick-workdir-row">
          <label for="quick-workdir">Working Directory:</label>
          <input id="quick-workdir" type="text" placeholder="~/project" autocomplete="off">
        </div>
      </div>
      <div class="quick-session-footer">
        <button id="quick-session-launch" class="ctrl-btn terminal">LAUNCH</button>
        <button id="quick-session-cancel" class="ctrl-btn">CANCEL</button>
      </div>
    </div>
  </div>

  <!-- Terminal Fullscreen Overlay -->
  <div id="terminal-fullscreen-overlay" class="terminal-fullscreen-overlay hidden">
    <div class="terminal-fullscreen-topbar">
      <span class="terminal-fullscreen-title">Terminal</span>
      <button id="terminal-fullscreen-exit" class="terminal-fullscreen-exit">EXIT FULLSCREEN (F11)</button>
    </div>
    <div id="terminal-fullscreen-container"></div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container"></div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
